@model TRS2._0.Models.ViewModels.PeriodDetailsViewModel

<div class="table-responsive mx-3 mb-4">
    <table class="table table-bordered table-striped table-hover">
        <thead class="thead-dark">
            <tr>
                <th class="nombre-columna">Nombre</th>
                @foreach (var monthDetail in Model.MonthDetails)
                {
                    <th>
                        <div style="border-bottom: 1px solid white; margin-bottom: 2px; margin-top: 8px; text-align: center">@monthDetail.Key</div>
                        <div style="text-align: center">@monthDetail.Value</div>
                    </th>
                }
            </tr>
        </thead>
        <tbody>
            @foreach (var person in Model.Persons)
            {
                <tr>
                    <td>@(person.Personnel.Name + " " + person.Personnel.Surname)</td>
                    @foreach (var monthDetail in Model.MonthDetails)
                    {
                        var monthDate = DateTime.Parse(monthDetail.Value);
                        decimal declaredHours = person.DeclaredHours.ContainsKey(monthDate) ? person.DeclaredHours[monthDate] : 0;
                        decimal hoursInProject = person.HoursinProyect.ContainsKey(monthDate) ? person.HoursinProyect[monthDate] : 0;
                        decimal completionPercentage = person.CompletionPercentage.ContainsKey(monthDate) ? person.CompletionPercentage[monthDate] : 0;

                        var statusKey = $"{monthDate.Year}-{monthDate.Month:D2}";
                        var status = person.PersonStatusByMonth.ContainsKey(statusKey) ? person.PersonStatusByMonth[statusKey] : (OutOfContract: false, Overloaded: false);
                        var backgroundColor = status.OutOfContract ? "#FF8C00" : (status.Overloaded ? "#FFFF00" : "");

                        <td style="background-color: @backgroundColor; padding: 4px; vertical-align: top;">
                            <div class="d-block" style="margin-bottom: 4px;">
                                <span class="font-weight-bold">@declaredHours | @hoursInProject</span>
                            </div>
                            <div class="progress" style="height: 10px;">
                                <div class="progress-bar" role="progressbar" style="width: @completionPercentage%; background-color: #28a745 !important;" aria-valuenow="@completionPercentage" aria-valuemin="0" aria-valuemax="100"></div>
                            </div>
                            <div class="text-center" style="font-size: 0.75rem;">@completionPercentage%</div>
                        </td>
                    }
                </tr>
            }

        </tbody>
    </table>
</div>




<style>

    .nombre-columna {
        min-width: 200px; /* Ajusta según necesites */
    }


</style>